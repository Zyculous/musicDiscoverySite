import{_ as c,c as n,a as s,t as g,w as d,v as p,d as u,f as w,o as l}from"./index-CvUhUh0g.js";const S="45d6d0678f9c4d9cbce9c7e1bbb2bc8f",f={data(){return{isSignUp:!0,signUpData:{username:"",email:"",password:"",repeatPassword:""},loginData:{email:"",password:""},emailError:"",passwordError:"",repeatPasswordError:"",loginEmailError:""}},methods:{validateEmail(){const i=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;this.emailError=i.test(this.signUpData.email)?"":"Invalid email format"},validatePassword(){this.passwordError=this.signUpData.password.length>=8?"":"Password must be at least 8 characters long"},validateRepeatPassword(){this.repeatPasswordError=this.signUpData.password===this.signUpData.repeatPassword?"":"Passwords do not match"},validateLoginEmail(){const i=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;this.loginEmailError=i.test(this.loginData.email)?"":"Invalid email format"},toggleForm(){this.isSignUp=!this.isSignUp},async handleSignUp(){if(this.validateEmail(),this.validatePassword(),this.validateRepeatPassword(),!(this.emailError||this.passwordError||this.repeatPasswordError)){try{const e=await fetch("http://localhost:5000/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.signUpData)}),a=await e.json();if(e.ok){console.log("Sign Up Successful:",a);var i=new Date(Date.now()+86400*1e3).toUTCString();document.cookie="loggedIn=true; expires="+i+";path=/;",this.$router.push("/account")}else console.error("Sign Up Failed:",a)}catch(e){console.error("Sign Up Failed:",e)}console.log("Sign Up Data:",this.signUpData)}},async refreshToken(){const i=localStorage.getItem("refresh_token"),e=" https://accounts.spotify.com/api/token",a={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:i,client_id:S})},o=await(await fetch(e,a)).json();localStorage.setItem("access_token",o.access_token),localStorage.setItem("refresh_token",o.refresh_token);const r=localStorage.getItem("refresh_token");console.log(r);try{const t=await fetch("http://localhost:5000/accountSettings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:localStorage.getItem("userEmail"),code:r})}),m=await t.json();t.ok?(console.log("Code Storage Successful:",m),this.$router.push("/account")):console.error("Storage Failed:",m)}catch(t){console.error("Storage Failed:",t)}},async handleLogin(){if(this.validateLoginEmail(),!this.loginEmailError){try{const e=await fetch("http://localhost:5000/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(this.loginData)}),a=await e.json();if(e.ok){console.log("Login Successful:",a),localStorage.setItem("userEmail",this.loginData.email),localStorage.setItem("profileImage",a.image);var i=new Date(Date.now()+86400*1e3).toUTCString();document.cookie="loggedIn=true; expires="+i+";path=/;",a.code&&(localStorage.setItem("refresh_token",a.code),await this.refreshToken()),this.$router.push("/account")}else console.error("Login Failed:",a)}catch(e){console.error("Login Failed:",e)}console.log("Login Data:",this.loginData)}}}},U={class:"auth-container"},E={key:0},y={class:"input-group"},v={class:"input-group"},D={key:0,class:"error"},P={class:"input-group"},k={key:0,class:"error"},b={class:"input-group"},I={key:0,class:"error"},L={key:1},T={class:"input-group"},C={key:0,class:"error"},F={class:"input-group"};function x(i,e,a,h,o,r){return l(),n("div",U,[s("button",{class:"topButton",onClick:e[0]||(e[0]=(...t)=>r.toggleForm&&r.toggleForm(...t))},g(o.isSignUp?"Switch to Login":"Switch to Sign Up"),1),o.isSignUp?(l(),n("div",E,[e[18]||(e[18]=s("h2",null,"Sign Up",-1)),s("form",{onSubmit:e[8]||(e[8]=w((...t)=>r.handleSignUp&&r.handleSignUp(...t),["prevent"]))},[s("div",y,[e[13]||(e[13]=s("label",null,"Username: ",-1)),d(s("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=t=>o.signUpData.username=t),required:""},null,512),[[p,o.signUpData.username]])]),s("div",v,[e[14]||(e[14]=s("label",null,"Email: ",-1)),d(s("input",{onInput:e[2]||(e[2]=(...t)=>r.validateEmail&&r.validateEmail(...t)),type:"email","onUpdate:modelValue":e[3]||(e[3]=t=>o.signUpData.email=t),required:""},null,544),[[p,o.signUpData.email]]),o.emailError?(l(),n("span",D,g(o.emailError),1)):u("",!0)]),s("div",P,[e[15]||(e[15]=s("label",null,"Password: ",-1)),d(s("input",{onInput:e[4]||(e[4]=(...t)=>r.validatePassword&&r.validatePassword(...t)),type:"password","onUpdate:modelValue":e[5]||(e[5]=t=>o.signUpData.password=t),required:""},null,544),[[p,o.signUpData.password]]),o.passwordError?(l(),n("span",k,g(o.passwordError),1)):u("",!0)]),s("div",b,[e[16]||(e[16]=s("label",null,"Repeat Password: ",-1)),d(s("input",{onInput:e[6]||(e[6]=(...t)=>r.validateRepeatPassword&&r.validateRepeatPassword(...t)),type:"password","onUpdate:modelValue":e[7]||(e[7]=t=>o.signUpData.repeatPassword=t),required:""},null,544),[[p,o.signUpData.repeatPassword]]),o.repeatPasswordError?(l(),n("span",I,g(o.repeatPasswordError),1)):u("",!0)]),e[17]||(e[17]=s("button",{type:"submit"},"Sign Up",-1))],32)])):(l(),n("div",L,[e[22]||(e[22]=s("h2",null,"Login",-1)),s("form",{onSubmit:e[12]||(e[12]=w((...t)=>r.handleLogin&&r.handleLogin(...t),["prevent"]))},[s("div",T,[e[19]||(e[19]=s("label",null,"Email: ",-1)),d(s("input",{onInput:e[9]||(e[9]=(...t)=>r.validateLoginEmail&&r.validateLoginEmail(...t)),type:"email","onUpdate:modelValue":e[10]||(e[10]=t=>o.loginData.email=t),required:""},null,544),[[p,o.loginData.email]]),o.loginEmailError?(l(),n("span",C,g(o.loginEmailError),1)):u("",!0)]),s("div",F,[e[20]||(e[20]=s("label",null,"Password: ",-1)),d(s("input",{type:"password","onUpdate:modelValue":e[11]||(e[11]=t=>o.loginData.password=t),required:""},null,512),[[p,o.loginData.password]])]),e[21]||(e[21]=s("button",{type:"submit"},"Login",-1))],32)]))])}const j=c(f,[["render",x],["__scopeId","data-v-70bcad43"]]);export{j as default};
